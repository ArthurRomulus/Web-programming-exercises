services:
  # Servicio para Apache - PHP
  app:    
    build: .
    container_name: Ejercicio1_app # Nombre del contenedor pe. Ejercicio1_app, etc
    restart: unless-stopped
    ports: 
      - "8001:80" # Mapear el puerto 8001 del host al puerto 80 del contenedor, Para Ejercicio 1: 8001, para Ejercicio 2: 8002, etc
    volumes:
      - ./app:/var/www/html # Montar el directorio actual en el contenedor
    networks:    
      - default  
    depends_on:
      - db

  # Servicio para MySQL
  db:
    image: mysql:8.0
    ports:
      - "3306:3306" # Mapear el puerto 3306 del host al puerto 3306 del contenedor, cambiar para cada ejercicio 3307:3306, 3308:3308, etc
    container_name: Ejercicio1_db # Nombre del contenedor pe. Ejercicio1_db, etc
    restart: unless-stopped
    environment:
      MYSQL_DATABASE: Ejercicio1_db # Nombre de la base de datos de cada ejercicio
      MYSQL_USER: Ejercicio1_user # Usuario de la base de datos de cada ejercicio
      MYSQL_PASSWORD: secret
      MYSQL_ROOT_PASSWORD: rootpassword
    volumes:
      - db_data:/var/lib/mysql # Persistencia de datos
    networks:
      - default
 

  # Servicio para PHPMyAdmin (opcional)
  phpmyadmin:
    image: phpmyadmin/phpmyadmin
    container_name: Ejercicio1_phpmyadmin
    restart: unless-stopped
    ports:
      - "8081:80" # Mapear el puerto 8081 del host al puerto 80 del contenedor, cambiar para cada ejercicio 8081:80, 8082:80, etc
    environment:
      #PMA_HOST: db
      #PMA_USER: Ejercicio1_user
      #PMA_PASSWORD: secret
      PMA_ARBITRARY: 1
      PMA_PORT: 3306 # Puerto del servicio de base de datos, cambiar para cada ejercicio 3306, 3307, 3308, etc
    networks:  
      - default    
    depends_on:
      - db

# Redes
networks:
  default:
    driver: bridge


# Vol√∫menes
volumes:
  db_data:
